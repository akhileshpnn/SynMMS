# Cellular Automata reaction diffusion simulations with Matlab

This collection of Matlab scripts and c++ code was written to allow simulation of reaction diffusion systems in 3D of multiple interacting species in arbitrary geometries that can be subdivided in compartments. For this, 3D space is subdivided into cuboidal voxels and each voxel has an 8-bit integer identifier to which compartment it belongs (e.g. 0 for outside, 255 for cytosolic, 1 for membrane). Each voxel can contain a concentration of multiple interacting species. For a binding reaction: tubulin + stathmin <--> tubulin-stathmin-dimer, 3 species need to be simulated.
The global computational routine of the simulation and interaction between Matlab and c++ code is defined in "maltesCA.cpp". In order to run the simulations, this file must be compiled from within Matlab by:
  mex maltesCA.cpp vec3d.cpp
Running a simulation requires three inputs:
  - a matlab struct of simulation parameters (vector of reaction constants, vector of diffusant radii for each species, number of iterations,...; a blank struct can be generated by running the function "maltesCA" without any input)
  - an N dimensional 8-bit matrix (N can be 1D, 2D, or 3D) defining the compartments
  - a N+1 dimensional matrix of initial float values for all species
and returns an N+2 dimensional (space, species, time) matrix of simulated values, where the "first" slice at t=0 is a copy of the N+1 dimensional initial values

A simulation from within Matlab is thus run by:
  Output = maltesCA(parameterStruct,definitionCompartments,initialValues);

# Reaction
Per simulation iteration, all interactions of all species in each voxel as defined in "helper_interact_StatTub.h" is calculated. For this project, chemical conversion of species (e.g. binding reaction above) is implemented as Euler-method integration of the differential equation with rate-constants defined as a vector in Matlab.

# Diffusion
For a given diffusant radius (e.g. of 3 voxels, can be different for each species), all voxels with the same identifier within that radius are diffusively linked (helper_initNeighb_StatTub.h) and per simulation iteration the concentration per voxel of this neighborhood is averaged (helper_diffuse.h).

Please refer to the Methods of the paper and the (poorly commented) code and scripts for more information. There is no separate matlab script file for the panels in Fig.4f, because the data plotted there is a condensed form of the data generated for Supplementary Fig. 6i-k.
